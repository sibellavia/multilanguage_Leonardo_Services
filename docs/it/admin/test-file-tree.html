<!DOCTYPE html>
<html>
<head>
    <title>Test File Tree</title>
    <link rel="stylesheet" href="editor.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
</head>
<body style="padding: 20px; font-family: Arial, sans-serif;">
    <h1>üå≥ Test File Tree Structure</h1>
    <div style="max-width: 400px; border: 1px solid #ddd; padding: 15px; border-radius: 8px;">
        <h3>File disponibili:</h3>
        <ul id="file-list-ul"></ul>
    </div>

    <script>
        // Simula la struttura file che avrai dal tuo editor
        const mockFileTree = {
            docs: {
                isFolder: true,
                children: {
                    en: {
                        isFolder: true,
                        children: {},
                        files: [
                            { name: "Administration.md", path: "docs/en/Administration.md" },
                            { name: "Authentication.md", path: "docs/en/Authentication.md" },
                            { name: "Dashboard.md", path: "docs/en/Dashboard.md" },
                            { name: "Getting started.md", path: "docs/en/Getting started.md" },
                            { name: "index.md", path: "docs/en/index.md" }
                        ]
                    },
                    it: {
                        isFolder: true,
                        children: {
                            admin: {
                                isFolder: true,
                                children: {},
                                files: [
                                    { name: "README-local-assets.md", path: "docs/it/admin/README-local-assets.md" }
                                ]
                            }
                        },
                        files: [
                            { name: "Administration.md", path: "docs/it/Administration.md" },
                            { name: "Authentication.md", path: "docs/it/Authentication.md" },
                            { name: "Dashboard.md", path: "docs/it/Dashboard.md" },
                            { name: "Getting started.md", path: "docs/it/Getting started.md" },
                            { name: "index.md", path: "docs/it/index.md" }
                        ]
                    }
                },
                files: []
            }
        };

        function buildFileTree() {
            let html = '';
            
            function renderFolder(folderData, folderName, level = 0) {
                const folderId = `folder-${folderName.replace(/[^a-zA-Z0-9]/g, '-')}-${level}`;
                
                html += `
                    <li class="folder-item">
                        <div class="folder-header" data-folder="${folderId}">
                            <span class="folder-icon">üìÅ</span>
                            <span class="folder-name">${folderName}</span>
                            <span class="folder-toggle">‚ñº</span>
                        </div>
                        <ul class="folder-content" id="${folderId}" style="display: block;">
                `;
                
                // Renderizza i file nella cartella
                folderData.files.forEach(file => {
                    html += `
                        <li class="file-item">
                            <span class="file-icon">üìÑ</span>
                            <a href="#" class="open-repo-file" data-path="${file.path}">${file.name}</a>
                        </li>
                    `;
                });
                
                // Renderizza le sottocartelle
                Object.keys(folderData.children).forEach(subFolderName => {
                    renderFolder(folderData.children[subFolderName], subFolderName, level + 1);
                });
                
                html += `
                        </ul>
                    </li>
                `;
            }
            
            // Inizia il rendering dall'albero principale
            Object.keys(mockFileTree).forEach(folderName => {
                if (mockFileTree[folderName] && mockFileTree[folderName].isFolder) {
                    renderFolder(mockFileTree[folderName], folderName);
                }
            });
            
            $("#file-list-ul").html(html);
            setupFolderToggle();
        }

        function setupFolderToggle() {
            $(".folder-header").off("click").on("click", function() {
                const folderId = $(this).data("folder");
                const folderContent = $(`#${folderId}`);
                const toggle = $(this).find(".folder-toggle");
                const icon = $(this).find(".folder-icon");
                
                if (folderContent.is(":visible")) {
                    folderContent.slideUp(200);
                    toggle.text("‚ñ∂");
                    icon.text("üìÅ");
                } else {
                    folderContent.slideDown(200);
                    toggle.text("‚ñº");
                    icon.text("üìÇ");
                }
            });
        }

        $(document).ready(function() {
            buildFileTree();

            // Test click sui file
            $(document).on("click", ".open-repo-file", function() {
                const filePath = $(this).data("path");
                
                // Rimuovi evidenziazione precedente
                $(".file-item a").removeClass("active");
                
                // Evidenzia il file corrente
                $(this).addClass("active");
                
                alert(`Caricato file: ${filePath}`);
            });
        });
    </script>
</body>
</html>